"use strict";function menuNodes(){this.menu=null,this.menuOpen=null,this.menuClose=null}function dropDownMenu(){this.menu=null,this.menuOpen=null,this.menuClose=null,this.root=null,this.isNotAcsbl=null,this.isDesktop=null,this.lastFocused=null,this.menuKids=[]}menuNodes.prototype.init=function(menuIcons,root,classNames){if(menuIcons&&classNames.menuClass&&classNames.menuOpen){if(this.root=root,this.menu=root.querySelector(classNames.menuClass),!this.menu)return;this.menuOpen=menuIcons.querySelector(classNames.menuOpen),this.menuClose=menuIcons.querySelector(classNames.menuClose),this.showKids(),this.hideKids()}},menuNodes.prototype.showKids=function(){var self=this;this.menuOpen&&this.menuOpen.addEventListener("click",(function(e){e.preventDefault(),self.menu.classList.remove("hidden"),self.menuClose&&(self.menuOpen.classList.add("hidden"),self.menuClose.classList.remove("hidden"))}))},menuNodes.prototype.hideKids=function(){var self=this;this.menuClose&&this.menuClose.addEventListener("click",(function(e){e.preventDefault(),self.menu.classList.add("hidden"),self.menuClose&&self.menuOpen.classList&&(self.menuOpen.classList.remove("hidden"),self.menuClose.classList.add("hidden"))}))},dropDownMenu.prototype.init=function(root){this.root=root,this.menu=root.querySelector(".j-menu"),this.menu&&(this.isNotAcsbl="ACCESSIBLE"!=window.PAGEDATA.theme,this.isDesktop=parseInt(document.body.offsetWidth)>1259,this.menuOpen=root.querySelector(".j-menu-open"),this.menuClose=root.querySelector(".j-menu-close"),this.initKids(),this.showMenuHandler(),this.hideMenuHandler())},dropDownMenu.prototype.initKids=function(){var menuNodesKids=this.menu.querySelectorAll(".j-menu-item");for(var key in menuNodesKids)if(menuNodesKids[key]instanceof HTMLElement){var menuItem=menuNodesKids[key],menuHandler=new menuNodes;this.menuKids.push(menuHandler.init(menuItem.querySelector(".j-menu-actions"),menuItem,{menuClass:".j-child",menuClose:".j-close",menuOpen:".j-open"}))}},dropDownMenu.prototype.showMenuHandler=function(){var self=this;this.menuOpen&&this.menuOpen.addEventListener("click",(function(e){e.preventDefault(),self.showMenu(),self.isNotAcsbl||self.focusModal(this,self.menu)}))},dropDownMenu.prototype.showMenu=function(){var isDesktop=parseInt(document.body.offsetWidth)>1259;if(this.menu.classList.remove("hidden"),this.isNotAcsbl&&this.menuClose&&(this.menuOpen.classList.add("hidden"),this.menuClose.classList.remove("hidden")),this.isNotAcsbl&&isDesktop){var coords=this.menu.getBoundingClientRect();document.body.clientWidth-coords.left<520&&(this.menu.style.left=document.body.clientWidth-Math.round(coords.left+520)+"px")}},dropDownMenu.prototype.hideMenuHandler=function(){var self=this;this.menuClose&&this.menuClose.addEventListener("click",(function(e){e.preventDefault(),self.hideMenu()})),this.isNotAcsbl?window.addEventListener("click",(function(event){self.root.contains(event.target)||self.hideMenu()})):this.root.addEventListener("keyup",(function(e){27===e.keyCode&&(e.preventDefault(),self.hideMenu())}))},dropDownMenu.prototype.hideMenu=function(){var isDesktop=parseInt(document.body.offsetWidth)>1259;this.menu.classList.add("hidden"),this.isNotAcsbl&&this.menuClose&&this.menuOpen.classList&&(this.menuOpen.classList.remove("hidden"),this.menuClose.classList.add("hidden")),this.isNotAcsbl&&isDesktop&&(this.menu.style.left=0),!this.isNotAcsbl&&this.lastFocused&&this.lastFocused.focus()},dropDownMenu.prototype.focusModal=function(control,modal){this.lastFocused=control;var focusableElements=modal.querySelectorAll('a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), iframe, object, embed, [tabindex="0"], [contenteditable]'),firstTabStop=(focusableElements=Array.prototype.slice.call(focusableElements))[0],lastTabStop=focusableElements[focusableElements.length-1];firstTabStop.focus();modal.addEventListener("keydown",(function(e){9===e.keyCode&&(e.shiftKey?document.activeElement===firstTabStop&&(e.preventDefault(),lastTabStop.focus()):document.activeElement===lastTabStop&&(e.preventDefault(),firstTabStop.focus()))}))};